{{- $work := false -}}
{{- $devtools := true -}}

{{- $relativeLocalInstallDir := joinPath ".local" "opt" }}
{{- $localInstallDir := joinPath .chezmoi.homeDir $relativeLocalInstallDir -}}
{{- $paths := dict
      "relativeLocalInstall" $relativeLocalInstallDir
      "localInstall" $localInstallDir
      "localInstallBin" (joinPath $localInstallDir "bin")
      "localInstallSbin" (joinPath $localInstallDir "sbin")
      "dotnetRoot" (joinPath $localInstallDir "dotnet")
-}}
{{- if eq "windows" .chezmoi.os -}}
{{- $scoop := joinPath $localInstallDir "scoop" -}}
{{- $paths = $paths | merge (dict
        "scoop" $scoop
        "bash" (joinPath $scoop "apps" "git" "current" "bin" "bash.exe")
    )
-}}
{{- end -}}

data:
  work: {{ $work }}
  devtools: {{ $devtools }}
  paths:
{{ $paths | toYaml | indent 4 }}
  environment:
    - name: AWS_PROFILE
      action: unset
    - name: KUBECONFIG
      action: unset
    - name: GPG_TTY
      action: command
      value: tty
    - name: IPYTHONDIR
      path: true
      value: {{ joinPath .chezmoi.homeDir ".config" "ipython" }}
    - name: LOCAL_INSTALL_DIR
      path: true
      value: {{ $paths.localInstall }}
      export: false
{{- if ne "windows" .chezmoi.os }}
    - name: DOTNET_ROOT
      path: true
      value: {{ $paths.dotnetRoot }}
    - name: DOTNET_INSTALL_DIR
      path: true
      value: {{ $paths.dotnetRoot }}
{{- end }}
{{-   $dataHome := joinPath .chezmoi.homeDir ".local" "share" }}
{{-   $configHome := joinPath .chezmoi.homeDir ".config" }}
{{-   $cacheHome := joinPath .chezmoi.homeDir ".cache" }}
{{-   $lunarvimRuntime := joinPath $dataHome "lunarvim" }}
    - name: XDG_DATA_HOME
      path: true
      persist: true
      value: {{ $dataHome }}
    - name: XDG_CONFIG_HOME
      path: true
      persist: true
      value: {{ $configHome }}
    - name: XDG_CACHE_HOME
      path: true
      persist: true
      value: {{ $cacheHome }}
    - name: LUNARVIM_RUNTIME_DIR
      path: true
      persist: true
      value: {{ $lunarvimRuntime }}
    - name: LUNARVIM_CONFIG_DIR
      path: true
      persist: true
      value: {{ joinPath $configHome "lvim" }}
    - name: LUNARVIM_CACHE_DIR
      path: true
      persist: true
      value: {{ joinPath $cacheHome "lvim" }}
    - name: LUNARVIM_BASE_DIR
      path: true
      persist: true
      value: {{ joinPath $lunarvimRuntime "lvim" }}
{{- if eq "windows" .chezmoi.os }}
    - name: SCOOP
      path: true
      persist: true
      value: {{ $paths.scoop }}
{{- else }}
{{- $asdf := joinPath .chezmoi.homeDir ".asdf" }}
{{- $asdfInstalls := joinPath $asdf "installs"}}
{{- $rustInstall := joinPath $asdfInstalls "rust" "stable" }}
    - name: ASDF_DIR
      value: $asdf
    - name: CARGO_HOME
      value: $rustInstall
    - name: RUSTUP_HOME
      value: $rustInstall
{{- end }}
    - name: PATH
      path: true
      action: prepend
      persist: true
      value:
        - {{ joinPath $.chezmoi.homeDir ".local" "bin" }}
        - {{ joinPath .chezmoi.homeDir ".dotnet" "tools" }}
        - {{ joinPath $paths.localInstallBin }}
{{- if ne "windows" .chezmoi.os }}
        - {{ $paths.dotnetRoot }}
{{- else }}
        - {{ joinPath .chezmoi.homeDir ".cargo" "bin" }}
{{- end }}

{{- if eq .chezmoi.os "windows" }}
interpreters:
  sh:
    command: {{ $paths.bash }}
  ps1:
    command: pwsh
    args:
      - "-NoLogo"
{{- end  }}
