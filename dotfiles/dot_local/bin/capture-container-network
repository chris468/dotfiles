#!/usr/bin/env bash

tmpdir=$(mktemp -d)

docker build -t tcpdump - <<EOF
FROM ubuntu
RUN apt-get update && apt-get install -y tcpdump
ENTRYPOINT ["tcpdump", "-i", "any"]
EOF

docker run -d --rm --net container:$1 -v $tmpdir:/data tcpdump -i any -A -w /data/packets.pcap

tail -c+0 -f $tmpdir/packets.pcap | wireshark -i -

