chezmoi:template:missing-key=zero
. {{ joinPath .paths.localInstallSbin "set-environment.ps1" }}

function script:scoop-install(
    [string]$name,
    [string]$bucket,
    [string[]]$versions) {
  if ($bucket -and !((scoop bucket list).name -contains "$bucket")) {
    scoop bucket add "$bucket"
    if ($LASTEXITCODE) { throw "Failed to add bucket $bucket" }
  }
  foreach ($version in $versions) {
    $op = if (scoop prefix $name 6>$null) { "update" } else { "install" }
    scoop $op "$name$version"
    if ($LASTEXITCODE) { Write-Error "Failed to $op $name$version" }
  }

  scoop reset ($name + $versions[0])
  if ($LASTEXITCODE) { Write-Error "Failed to set default to $name$versions[0]" }
}

function script:scoop-remove(
    [string]$name,
    [string[]]$versions) {
  foreach ($version in $versions) {
    scoop uninstall "$name$version"
    if ($LASTEXITCODE) { Write-Error "Failed to remove $name$version" }
  }
}

function install-dotnet([string[]]$versions) {
  foreach ($version in $versions) {
    winget install "Microsoft.DotNet.SDK.$version"
  }
}
