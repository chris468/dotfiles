{{- $config := includeTemplate "config" . | fromJson -}}
{{ if $config.gitCredentialManager.install -}}
{{ $gcmAssetPattern := dict
     "windows" "gcm-win-x86*.zip"
     "darwin" (printf "gcm-osx-%s-*.tar.gz" .chezmoi.arch)
     "linux" (printf "gcm-linux_%s.*.tar.gz" .chezmoi.arch)
-}}
{{ includeTemplate "path" (dict "path" "gitCredentialManager" "relative" true "chezmoi" .chezmoi) | quote }}:
  type: archive
  exact: true
{{- if eq .chezmoi.os "darwin" }}
  stripComponents: 2
{{- end }}
  url: {{ gitHubLatestReleaseAssetURL "git-ecosystem/git-credential-manager" (.chezmoi.os | index $gcmAssetPattern) }}
{{- end }}
